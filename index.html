<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<title>RAVE N SUNSET</title>

<style>
:root{
  --bg:#ffffff;
  --ink:#000000;
  --blue:#003cff;
  --acid:#00aaff;
  --alert:#ff0000;
  
  --font-head: Impact, Haettenschweiler, "Arial Narrow Bold", sans-serif;
  --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  --font-mono: "Courier New", monospace;
}

*{margin:0;padding:0;box-sizing:border-box}

/* FIX: Ensure HTML has black background to prevent bottom gap */
html {
  height: 100%;
  background: #000; 
}

body {
  height: 100%; 
  min-height: 100dvh; 
  overscroll-behavior: none; 
  background: #000; 
  -webkit-tap-highlight-color: transparent; 
  
  font-family: var(--font-body);
  overflow-y: auto; 
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  -webkit-text-size-adjust: 100%;
  transition: background-color 0.2s ease;
}

/* === GLOBAL VHS OVERLAYS === */

.scanlines {
  position: fixed;
  inset: 0; /* Use inset:0 to ensure full viewport coverage */
  width: 100%; height: 100dvh;
  /* Default: Dark Lines (Normal Mode) */
  background: repeating-linear-gradient(
    0deg,
    rgba(0, 0, 0, 0.4),
    rgba(0, 0, 0, 0.4) 1px,
    transparent 1px,
    transparent 2px
  );
  pointer-events: none;
  z-index: 2147483647; 
  backdrop-filter: sepia(20%) contrast(1.2) brightness(0.9);
  transition: background 0.5s ease;
}

.tracking-line {
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 15vh;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, 0.1), rgba(0,0,0,0.5), transparent);
  animation: scan 4s linear infinite;
  pointer-events: none;
  z-index: 2147483647;
  mix-blend-mode: exclusion;
}

@keyframes scan {
  0% { top: -20%; opacity: 0; }
  10% { opacity: 1; }
  90% { opacity: 1; }
  100% { top: 120%; opacity: 0; }
}

/* === INTRO LAYER (CRT TUBE) === */
#intro-layer {
  position: fixed;
  top: 0; left: 0; width: 100%; height: 100dvh;
  background: #000;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  overflow: hidden;
}

.crt-screen {
  position: relative;
  width: 90vw;
  height: 80vh; 
  min-height: 500px;
  max-width: 800px;
  background: #000;
  animation: horror-pulse 0.15s infinite alternate;
  border-radius: 20px;
  box-shadow: 
    0 0 0 100vmax #000, 
    inset 0 0 80px rgba(0,0,0,1);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  overflow: hidden;
  transform: perspective(1000px) scale(0.95);
}

.crt-screen::before {
  content: "";
  position: absolute;
  top: 0; left: 0; width: 100%; height: 100%;
  background: radial-gradient(circle at 50% 30%, rgba(255,255,255,0.08), transparent 60%);
  pointer-events: none;
  z-index: 2;
  border-radius: 20px;
}

@keyframes horror-pulse {
  0% { background: #000000; }
  50% { background: #1a0000; }
  100% { background: #350000; } 
}

.studio-54 {
  font-family: var(--font-head);
  font-size: clamp(2.5rem, 12vw, 5rem);
  line-height: 0.9;
  text-transform: uppercase;
  font-style: italic;
  z-index: 5;
  color: transparent;
  -webkit-text-stroke: 1px #ffd700;
  text-shadow: 4px 4px 0px #8B0000, -2px -2px 0px #000088;
  animation: tear-signal 2.5s infinite steps(1);
}

.studio-54 .presents {
  display: block;
  font-size: 0.4em;
  font-family: var(--font-mono);
  color: #fff;
  letter-spacing: 0.5em;
  margin-top: 10px;
  text-shadow: none;
  -webkit-text-stroke: 0;
  background: #000;
  padding: 5px;
  transform: skewX(-15deg);
}

@keyframes tear-signal {
  0% { clip-path: inset(0 0 0 0); transform: translateX(0); }
  5% { clip-path: inset(10% 0 80% 0); transform: translateX(-5px); }
  10% { clip-path: inset(0 0 0 0); transform: translateX(0); }
  40% { clip-path: inset(40% 0 10% 0); transform: translateX(10px) skewX(20deg); filter: invert(1); }
  45% { clip-path: inset(0 0 0 0); transform: translateX(0); filter: invert(0); }
  80% { clip-path: inset(0 0 0 0); opacity: 1; }
  82% { opacity: 0; }
  84% { opacity: 1; }
  100% { clip-path: inset(0 0 0 0); }
}

.channel-indicator {
  position: absolute;
  top: 10%;
  left: 10%;
  font-family: var(--font-mono);
  color: #0f0;
  font-size: 1rem;
  text-shadow: 0 0 5px #0f0;
  border: 2px solid #0f0;
  padding: 5px 8px;
  box-shadow: 0 0 10px #0f0;
  z-index: 5;
}

/* === STATIC BLAST & OVERLAY === */
#static-overlay {
  position: fixed;
  inset: 0; width: 100%; height: 100%;
  background: repeating-conic-gradient(#000 0% 25%, #fff 0% 50%);
  background-size: 4px 4px;
  opacity: 0; /* Hidden by default */
  pointer-events: none;
  z-index: 20000;
  mix-blend-mode: overlay;
}

.channel-switch-active {
  animation: static-nuke 0.8s steps(3) forwards;
}

@keyframes static-nuke {
  0% { opacity: 0; }
  10% { opacity: 1; filter: invert(1); transform: scale(1.1); }
  30% { opacity: 1; filter: invert(0); background-size: 20px 20px; transform: translateX(-10px); }
  50% { opacity: 1; filter: contrast(5); transform: skewX(50deg); }
  80% { opacity: 0.5; }
  100% { opacity: 0; pointer-events: none; }
}

/* === VHS STROBE OVERLAY === */
.vhs-strobe-overlay {
  position: fixed;
  inset: 0; width: 100%; height: 100%;
  pointer-events: none;
  z-index: 20001; /* Above static */
  display: none;
}
/* The Moving Bar */
.vhs-strobe-overlay::after {
  content: "";
  position: absolute;
  left: 0; width: 100%; height: 20vh;
  background: rgba(255,255,255,0.1);
  box-shadow: 0 0 50px rgba(255,255,255,0.3);
  top: -20%;
}

/* === MAIN CONTENT === */
.page-wrapper {
  background: var(--bg);
  color: var(--ink);
  min-height: 100dvh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  opacity: 0; 
  transition: opacity 0.1s; 
  padding-bottom: env(safe-area-inset-bottom);
}

.show-content { opacity: 1 !important; }

.page{
  width: 100%;
  max-width:480px;
  margin:0 auto;
  padding:2rem 1.5rem 4rem;
  position: relative;
  z-index: 1;
}

/* GLITCHY TITLE */
@keyframes text-glitch {
  0% { transform: translate(0) }
  20% { transform: translate(-3px, 3px) }
  40% { transform: translate(-3px, -3px) }
  60% { transform: translate(3px, 3px) }
  80% { transform: translate(3px, -3px) }
  100% { transform: translate(0) }
}

.title{
  font-family:var(--font-head);
  font-size: clamp(3.5rem, 12vw, 4.5rem);
  line-height:.85;
  letter-spacing:-2px;
  cursor: default;
  mix-blend-mode: hard-light;
  user-select: none;
  text-shadow: 2px 2px 0px rgba(0,255,255,0.5), -2px -2px 0px rgba(255,0,0,0.5);
  animation: text-glitch 3s infinite steps(10);
  transition: all 0.2s;
}

.title:active { transform: scale(0.98); }
.title span{ color:var(--blue); }

.block{
  margin-top:1.4rem;
  border:2px solid #000;
  padding:.8rem;
  box-shadow: 4px 4px 0px rgba(0,0,0,0.1); 
  transition: transform 0.5s ease;
}
.block.blue{ background:#e9f1ff; }
.block.black{ background:#000; color:#fff; }
.block.black .blue{ color:#6bb2ff; }

.countdown{
  font-family:var(--font-mono);
  font-size:1.1rem;
  letter-spacing:1px;
}
.countdown span{
  display:inline-block;
  min-width:2ch;
  color:var(--alert);
  text-shadow: 0 0 5px var(--alert); 
}

.info{ font-size:.95rem; line-height:1.5; }
.info strong{ font-weight:700; }
.dress{ margin-top:.6rem; font-size:.9rem; letter-spacing:1px; }
.dress .hint{ color:var(--alert); font-weight:700; }

.actions{ margin-top:2rem; display:flex; flex-wrap:wrap; gap:.6rem; }
.btn{
  border:2px solid #000;
  background:#fff;
  padding:.8rem 1.4rem;
  font-size:.7rem;
  font-weight: 700;
  letter-spacing:2px;
  text-transform:uppercase;
  text-decoration:none;
  color:#000;
  cursor: pointer;
  transition: all 0.1s;
  -webkit-tap-highlight-color: transparent;
}
.btn:active { transform: translate(2px, 2px); box-shadow: none; }
.btn:hover{ background:#000; color:#fff; box-shadow: 3px 3px 0 var(--blue); }

.footer{
  margin-top:3rem;
  font-size:.6rem;
  letter-spacing:1px;
  opacity:.75;
  text-transform:uppercase;
  border-top: 1px solid #ccc;
  padding-top: 1rem;
}

/* HIDDEN VOID TRIGGER */
#void-trigger {
  margin-top: 2rem;
  font-family: var(--font-mono);
  font-size: 0.6rem;
  color: #1a1a1a;
  text-align: center;
  letter-spacing: 2px;
  cursor: pointer;
  opacity: 0.3;
  transition: all 0.3s ease;
  user-select: none;
  padding: 10px;
}
#void-trigger:hover, #void-trigger:active {
  color: var(--alert);
  opacity: 1;
  text-shadow: 0 0 4px red;
  letter-spacing: 4px;
}

/* === BIO-VEIN OVERLAY === */
#vein-overlay {
  position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  pointer-events: none;
  z-index: 0;
  opacity: 0;
  transition: opacity 1s ease;
  mix-blend-mode: multiply;
}

/* === HORROR MODE (FLESH) === */
body.flesh-mode {
  background: #000 !important;
}

/* HIJACK TRANSITION */
body.hijack-active {
  animation: signal-hijack 0.6s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
}

@keyframes signal-hijack {
  10%, 90% { transform: translate3d(-2px, 0, 0); filter: invert(1); }
  20%, 80% { transform: translate3d(2px, 0, 0); }
  30%, 50%, 70% { transform: translate3d(-4px, 0, 0); filter: invert(0); }
  40%, 60% { transform: translate3d(4px, 0, 0); }
}

/* ACTIVATED FLESH STYLES */
body.flesh-mode #vein-overlay {
  opacity: 0.7;
  animation: vascular-pump 0.857s infinite; /* ~70 BPM */
}

body.flesh-mode .page-wrapper {
  background: transparent;
  color: #ff0000; 
}

body.flesh-mode .title {
  color: #ff0000 !important;
  text-shadow: 0 0 15px #ff0000;
  animation: tear-signal 3s infinite steps(1); 
}

body.flesh-mode .block {
  background: rgba(20, 0, 0, 0.8);
  border-color: #500;
  box-shadow: 0 0 10px #300;
  animation: breathing-ui 1.714s ease-in-out infinite alternate; /* 2 beats */
}
body.flesh-mode .block.blue {
  color: #ff0000;
  background: #000;
}

body.flesh-mode .btn {
  background: #100;
  color: #500;
  border-color: #500;
}

@keyframes vascular-pump {
  0% { transform: scale(1); filter: contrast(1) brightness(1); }
  15% { transform: scale(1.02); filter: contrast(1.2) brightness(1.3); } /* Lub */
  30% { transform: scale(1.01); filter: contrast(1.1) brightness(1.1); }
  45% { transform: scale(1.03); filter: contrast(1.3) brightness(1.4); } /* Dub */
  100% { transform: scale(1); filter: contrast(1) brightness(1); }
}

@keyframes breathing-ui {
  0% { transform: scale(1); }
  100% { transform: scale(1.02); }
}

/* === TV OFF ANIMATION (EASTER EGG) === */
.tv-off-animation {
  animation: turn-off 0.6s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

@keyframes turn-off {
  0% { transform: scale(1, 1); filter: brightness(1); }
  60% { transform: scale(1, 0.005); filter: brightness(10); }
  100% { transform: scale(0, 0); filter: brightness(0); }
}

/* ========================================= */
/* ===  SIGNAL BREACH ENDING (ACTIVE)    === */
/* ========================================= */

body.live-active {
  background: #000000 !important; /* FIXED: BLACK BG */
  animation: panic-pulse 0.5s infinite alternate;
  
  /* Standard clarity (no blur) so it looks clean like Flesh Mode */
  filter: contrast(1.1) brightness(1.1);
}

/* == CHAOS MODE SCANLINES (Fixed to match normal mode) == */
/* Pattern matches normal mode exactly, but faintly red */
body.live-active .scanlines {
  background: repeating-linear-gradient(
    0deg,
    rgba(255, 0, 0, 0.1), /* Very subtle red tint (10% opacity) */
    rgba(255, 0, 0, 0.1) 1px,
    transparent 1px,
    transparent 2px
  );
  /* No backdrop filter to keep it clean */
  backdrop-filter: none;
}

/* 1. NOTABLE VHS OVERLAYS */
body.live-active #static-overlay {
  opacity: 0.35 !important; 
  animation: noise-move 0.2s infinite;
  display: block;
}
body.live-active .vhs-strobe-overlay {
  display: block;
  animation: strobe-flash 0.15s infinite alternate; 
}
body.live-active .vhs-strobe-overlay::after {
  animation: bar-roll 4s linear infinite;
  background: rgba(255,255,255,0.15);
}

@keyframes noise-move {
  0% { background-position: 0 0; }
  100% { background-position: 100px 100px; }
}
@keyframes bar-roll {
  0% { top: -20%; opacity: 0; }
  10% { opacity: 0.8; }
  90% { opacity: 0.8; }
  100% { top: 120%; opacity: 0; }
}
@keyframes strobe-flash {
  0% { background: transparent; }
  95% { background: transparent; }
  100% { background: rgba(255,255,255,0.15); } 
}

body.live-active .page-wrapper {
  background: transparent;
  color: #fff;
}

/* 2. CHAOS TITLE (RED LIKE FLESH MODE) */
body.live-active .title {
  color: #ff0000 !important;
  text-shadow: 0 0 15px #ff0000; /* Glowing red */
  animation: tear-signal 2s infinite steps(2); 
}
body.live-active .title span { color: #ff0000; }

body.live-active .block {
  border-color: #ff0000;
  background: #000;
  box-shadow: 5px 5px 0 #500;
}

/* 3. SIGNAL BOX: RED BORDER, RED GLOW */
body.live-active .block.blue {
  background: #000; 
  border: 2px solid #ff0000; 
  box-shadow: 0 0 15px #ff0000; /* Red Glow */
  color: #ff0000; 
  display: flex;
  justify-content: center;
  align-items: center;
}

body.live-active .countdown {
  font-weight: 900;
  font-size: clamp(1.5rem, 5vw, 2.5rem);
  text-align: center;
  line-height: 1.1;
  color: #ff0000; 
  text-shadow: 0 0 10px #ff0000; 
  width: 100%;
  animation: simple-blink 1.5s infinite step-end;
}

body.live-active .info, 
body.live-active .dress {
  color: #ffcccc;
}

/* 4. BUTTONS: BLACK BG, RED TEXT, RED BORDER */
body.live-active .btn {
  background: #000 !important;
  color: #ff0000 !important;
  border: 2px solid #ff0000 !important;
  box-shadow: 0 0 10px #ff0000;
}
body.live-active .btn:hover {
  background: #ff0000 !important;
  color: #000 !important;
}

@keyframes panic-pulse {
  0% { background-color: #1a0000; filter: contrast(1.2); }
  100% { background-color: #300000; filter: contrast(2); }
}

@keyframes simple-blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/* === BSOD LAYER === */
#bsod-layer {
  display: none;
  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
  background: #0000AA; color: #fff;
  font-family: 'Courier New', Courier, monospace;
  padding: 40px; font-size: 1.2rem; z-index: 999999;
  cursor: none;
}
.blink-underscore { animation: blink 1s infinite; }
@keyframes blink { 50% { opacity: 0; } }
</style>
</head>

<body>
<div class="scanlines"></div>
<div class="tracking-line"></div>
<div id="static-overlay"></div>
<div class="vhs-strobe-overlay"></div>

<svg id="vein-overlay" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
  <defs>
    <filter id="vein-noise" x="0%" y="0%" width="100%" height="100%">
      <feTurbulence type="fractalNoise" baseFrequency="0.015" numOctaves="3" result="noise"/>
      <feColorMatrix type="matrix" values="1 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 18 -7" in="noise" result="coloredNoise"/>
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="50" xChannelSelector="R" yChannelSelector="G"/>
    </filter>
  </defs>
  <rect width="100%" height="100%" fill="#500000" filter="url(#vein-noise)" opacity="0.8"/>
</svg>

<div id="intro-layer">
  <div class="crt-screen">
    <div class="channel-indicator">CH 83</div>
    <div class="studio-54">
      STUDIO 54<br>
      <span class="presents">PRESENTS</span>
    </div>
  </div>
</div>

<div class="page-wrapper" id="main-wrapper">
  <div class="page">

    <div class="title" id="egg-trigger">
      RAVE<br>
      <span>N</span><br>
      SUNSET
    </div>

    <div class="block blue">
      <div class="countdown">
        <span id="d">00</span>D :
        <span id="h">00</span>H :
        <span id="m">00</span>M :
        <span id="s">00</span>S
      </div>
    </div>

    <div class="block">
      <div class="info">
        <strong class="blue">SATURDAY</strong><br>
        JANUARY 17, 2026<br>
        <strong class="blue">5:00 PM · CST</strong><br><br>
        HUERTAS DEL CARMEN<br>
        BUGAMBILIAS 16<br>
        QUERÉTARO, MX
      </div>

      <div class="dress">
        COME DRESSED FOR THE SKY<br>
        <span class="hint">WHITE / BLUE</span>
      </div>
    </div>

    <div class="block black">
      <div class="info">
        NO PHONES · NO PHOTOS<br>
        ENTRY AT SUNSET<br>
        SIGNAL LOSS EXPECTED
      </div>
    </div>

    <div class="actions">
      <a class="btn" target="_blank"
         href="https://www.google.com/maps/search/?api=1&query=Bugambilias+16+Huertas+del+Carmen+Queretaro">
        MAP
      </a>
      <button class="btn" id="cal">CALENDAR</button>
    </div>

    <div class="footer">
      RAVE N SUNSET · JAN 17 · CST
    </div>
    
    <div id="void-trigger">ENTER THE VOID</div>

  </div>
</div>

<div id="bsod-layer">
  <p>A fatal exception 0E has occurred at 0028:C0034B23 in VXD VMM(01) + 00004323.</p>
  <p>The current application will be terminated.</p>
  <br>
  <p>* Press any key to terminate the current application.</p>
  <p>* Press CTRL+ALT+DEL again to restart your computer. You will lose any unsaved information in all applications.</p>
  <br>
  <p>Press any key to continue <span class="blink-underscore">_</span></p>
</div>

<script>
// ==========================================
//  DEPLOYMENT SETTING
//  true  = Preview Ending Immediately
//  false = Wait for Real Date (Jan 17 2026)
// ==========================================
const TEST_LIVE_MODE = false; 

// --- INTRO SEQUENCE ---
window.onload = function() {
  const intro = document.getElementById('intro-layer');
  const staticOverlay = document.getElementById('static-overlay');
  const wrapper = document.querySelector('.page-wrapper');
  
  if(TEST_LIVE_MODE) {
    intro.remove();
    wrapper.classList.add('show-content');
    return;
  }

  setTimeout(() => {
    staticOverlay.classList.add('channel-switch-active');
    setTimeout(() => {
      intro.style.display = 'none'; 
      wrapper.classList.add('show-content'); 
      document.documentElement.style.setProperty('--flicker-strength', '0.5');
    }, 300);
    setTimeout(() => { intro.remove(); }, 1000);
  }, 3000); 
};

// --- COUNTDOWN LOGIC ---
const EVENT = { date: "2026-01-17T17:00:00-06:00", duration: 5 };
const dEl = document.getElementById('d');
const hEl = document.getElementById('h');
const mEl = document.getElementById('m');
const sEl = document.getElementById('s');
let liveTriggered = false;

function tick(){
  const now = Date.now();
  // If Test Mode is ON, pretend the event was 1 second ago
  const eventTime = TEST_LIVE_MODE ? now - 1000 : new Date(EVENT.date).getTime();
  const t = eventTime - now;

  // === THE ENDING TRIGGER ===
  if(t <= 0){
    if(!liveTriggered) triggerSignalBreach();
    return;
  }

  const d=Math.floor(t/864e5), h=Math.floor(t/36e5)%24, m=Math.floor(t/6e4)%60, s=Math.floor(t/1e3)%60;
  dEl.textContent=String(d).padStart(2,"0"); hEl.textContent=String(h).padStart(2,"0");
  mEl.textContent=String(m).padStart(2,"0"); sEl.textContent=String(s).padStart(2,"0");
}

function triggerSignalBreach() {
  liveTriggered = true;
  document.body.classList.add('live-active');
  
  // Update Countdown Text Only
  const countBox = document.querySelector(".countdown");
  countBox.innerHTML = "SIGNAL<br>ACQUIRED";
  
  // Maximize Chaos Variables (INTENSE OVERLAY)
  const root = document.documentElement;
  root.style.setProperty('--rgb-shift', '20px'); 
  root.style.setProperty('--scan-opacity', '0.7'); 
  root.style.setProperty('--flicker-strength', '0.1'); 
  
  // Play a "static blast" effect visually
  const staticOverlay = document.getElementById('static-overlay');
  if(staticOverlay) {
    staticOverlay.classList.remove('channel-switch-active'); 
    void staticOverlay.offsetWidth; // trigger reflow
    staticOverlay.classList.add('channel-switch-active');
  }
}

setInterval(tick,1000);
tick();

// --- CALENDAR BUTTON ---
document.getElementById("cal").onclick=()=>{
  const start=new Date(EVENT.date);
  const end=new Date(start.getTime()+EVENT.duration*36e5);
  const f=d=>d.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z";
  const ics=["BEGIN:VCALENDAR","VERSION:2.0","BEGIN:VEVENT",`UID:${Date.now()}@rns`,`DTSTAMP:${f(new Date())}`,`DTSTART:${f(start)}`,`DTEND:${f(end)}`,"SUMMARY:Rave N Sunset","DESCRIPTION:White or blue. Bugambilias 16, Huertas del Carmen.","LOCATION:Bugambilias 16, Huertas del Carmen, Querétaro, MX","END:VEVENT","END:VCALENDAR"].join("\r\n");
  const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
  if(isIOS) { window.open(url); } else {
    const a=document.createElement("a"); a.href=url; a.download="rave-n-sunset.ics";
    document.body.appendChild(a); a.click(); document.body.removeChild(a);
  }
};

// --- CHAOS ENGINE (Standard Mode) ---
let secondsOpen = 0;
const root = document.documentElement;
setInterval(() => {
  // Only run standard chaos if we haven't triggered the live event
  if(liveTriggered) return; 

  secondsOpen++;
  const shift = Math.min(2 + (secondsOpen * 0.1), 8); 
  root.style.setProperty('--rgb-shift', shift + "px");
  const opacity = Math.min(0.2 + (secondsOpen * 0.005), 0.4);
  root.style.setProperty('--scan-opacity', opacity);
}, 1000);

// ============================================
// === FLESH MODE ENGINE (Audio & Visuals) ===
// ============================================

let audioCtx;
let heartInterval;
const BPM_INTERVAL = 857; // ~70 BPM (60000 / 70)

function initAudio() {
  if (!audioCtx) {
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    audioCtx = new AudioContext();
  }
  if (audioCtx.state === 'suspended') {
    audioCtx.resume();
  }
}

function playHeartbeat() {
  if (!audioCtx) return;
  const t = audioCtx.currentTime;
  
  // OSC 1: LUB (Lower, Thud)
  const osc1 = audioCtx.createOscillator();
  const gain1 = audioCtx.createGain();
  osc1.frequency.value = 55; // Low thud
  osc1.type = 'triangle';
  osc1.connect(gain1);
  gain1.connect(audioCtx.destination);
  
  osc1.start(t);
  gain1.gain.setValueAtTime(0, t);
  gain1.gain.linearRampToValueAtTime(0.8, t + 0.05);
  gain1.gain.exponentialRampToValueAtTime(0.001, t + 0.15);
  osc1.stop(t + 0.2);

  // OSC 2: DUB (Slightly higher, sharper)
  const osc2 = audioCtx.createOscillator();
  const gain2 = audioCtx.createGain();
  osc2.frequency.value = 45;
  osc2.type = 'triangle';
  osc2.connect(gain2);
  gain2.connect(audioCtx.destination);
  
  osc2.start(t + 0.25); // Offset
  gain2.gain.setValueAtTime(0, t + 0.25);
  gain2.gain.linearRampToValueAtTime(0.6, t + 0.3);
  gain2.gain.exponentialRampToValueAtTime(0.001, t + 0.5);
  osc2.stop(t + 0.6);

  // ADD HAPTICS
  if (navigator.vibrate) {
    navigator.vibrate([50]); // Short vibe on the beat
  }
}

function toggleFleshMode() {
  const body = document.body;
  const title = document.querySelector('.title');
  
  // Trigger Hijack Animation
  body.classList.add('hijack-active');
  setTimeout(() => body.classList.remove('hijack-active'), 600);

  const isActive = body.classList.toggle('flesh-mode');

  if (isActive) {
    title.innerHTML = "LONG LIVE<br>THE NEW<br>FLESH";
    
    // Start Audio
    initAudio();
    playHeartbeat(); // First beat immediately
    clearInterval(heartInterval);
    heartInterval = setInterval(playHeartbeat, BPM_INTERVAL);
    
  } else {
    title.innerHTML = "RAVE<br><span>N</span><br>SUNSET";
    clearInterval(heartInterval);
  }
}

// --- EASTER EGG 1: KEYBOARD "FLESH" MODE ---
let keyBuffer = "";
document.addEventListener('keydown', (e) => {
  keyBuffer += e.key.toUpperCase();
  if (keyBuffer.length > 5) keyBuffer = keyBuffer.slice(-5);
  
  if (keyBuffer === "FLESH") {
    toggleFleshMode();
  }
});

// --- EASTER EGG 2: TAP SPAM "TV KILL" ---
let tapCount = 0;
let tapTimer = null;
const eggTrigger = document.getElementById('egg-trigger');

eggTrigger.addEventListener('click', () => {
  tapCount++;
  clearTimeout(tapTimer);
  tapTimer = setTimeout(() => { tapCount = 0; }, 1000);
  
  if (tapCount >= 7) {
    tapCount = 0;
    document.body.classList.add('tv-off-animation');
    setTimeout(() => { location.reload(); }, 2500);
  }
});

// --- EASTER EGG 3: MOBILE "VOID" TRIGGER ---
document.getElementById('void-trigger').addEventListener('click', () => {
  // Try to initialize audio on first interaction (iOS policy)
  initAudio();
  
  const pass = prompt("/// AWAITING INPUT ///");
  if(pass && pass.toUpperCase().trim() === "FLESH") {
    // Check if mode is already active to prevent double toggle
    if(!document.body.classList.contains('flesh-mode')) {
      toggleFleshMode();
    }
  } else if (pass) {
    alert("ACCESS DENIED");
  }
});

// --- NEW EASTER EGG 4: KONAMI BSOD ---
const konamiCode = ["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a"];
let kPosition = 0;

document.addEventListener('keydown', function(e) {
  if (e.key === konamiCode[kPosition]) {
    kPosition++;
    if (kPosition === konamiCode.length) {
      triggerBSOD();
      kPosition = 0;
    }
  } else {
    kPosition = 0;
  }
});

function triggerBSOD() {
  const bsod = document.getElementById('bsod-layer');
  bsod.style.display = 'block';
  document.body.style.overflow = 'hidden';
}

// --- NEW EASTER EGG 5: SUBLIMINAL GLITCH ---
const creepyWords = ["OBEY", "CONSUME", "SLEEP", "NO EXIT", "WATCHING", "VOID"];
const targetElements = document.querySelectorAll('.info, .dress, .footer');

setInterval(() => {
  if(Math.random() > 0.9) { // Rare trigger
    const target = targetElements[Math.floor(Math.random() * targetElements.length)];
    const originalText = target.innerText;
    
    target.style.color = "red";
    target.style.fontFamily = "Courier New";
    target.innerText = creepyWords[Math.floor(Math.random() * creepyWords.length)];
    
    setTimeout(() => {
      target.innerText = originalText;
      target.style.color = "";
      target.style.fontFamily = "";
    }, 100);
  }
}, 2000);

// --- NEW EASTER EGG 6: CONSOLE GHOST ---
console.log(
  "%c STOP LOOKING. \n YOU ARE NOT SUPPOSED TO BE HERE. ",
  "background: #000; color: #ff0000; font-size: 20px; padding: 20px; border: 2px solid red;"
);
console.log(
  "%c(If you are looking for the venue coordinates, they are buried in the source code...)", 
  "color: #555;"
);
</script>
</body>
</html>
